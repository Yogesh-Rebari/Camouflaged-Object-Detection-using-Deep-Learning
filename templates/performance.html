{% extends 'base.html' %}
{% block title %}YOLOv8 | Performance &amp; Metrics{% endblock %}
{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/model_style.css') }}">
{% endblock %}

{% block content %}
    <main class="model-page">
        <section class="page-hero">
            <div class="container">
                <h1>Performance &amp; Evaluation Metrics</h1>
                <p>
                    Comprehensive performance metrics and evaluation results for the Camouflaged Military Soldier Detection model.
                </p>
            </div>
        </section>

        <!-- Performance Image Section -->
        <section class="model-image-section">
            <div class="container">
                <div class="model-image-container">
                    <img src="{{ url_for('static', filename='images/cod02.png') }}" alt="Performance Metrics Visualization">
                </div>
            </div>
        </section>

        <!-- Key Performance Metrics -->
        <section class="model-architecture" id="metrics">
            <div class="container">
                <h2>Key Performance Metrics</h2>
                <p>
                    The model was evaluated on a validation set after training for 100 epochs. The following metrics
                    demonstrate the model's effectiveness in detecting camouflaged military soldiers across various scenarios.
                </p>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <h3>mAP@0.5</h3>
                        <p>Mean Average Precision at IoU threshold 0.5</p>
                    </div>
                    <div class="metric-card">
                        <h3>mAP@0.5:0.95</h3>
                        <p>Mean Average Precision across IoU thresholds 0.5 to 0.95</p>
                    </div>
                    <div class="metric-card">
                        <h3>Precision</h3>
                        <p>Ratio of true positive detections to all positive predictions</p>
                    </div>
                    <div class="metric-card">
                        <h3>Recall</h3>
                        <p>Ratio of true positive detections to all actual positives</p>
                    </div>
                    <div class="metric-card">
                        <h3>F1-Score</h3>
                        <p>Harmonic mean of Precision and Recall</p>
                    </div>
                </div>
                
                <!-- Performance Visualization Charts -->
                <div class="charts-grid" style="margin-top: var(--spacing-md);">
                    <div class="chart-container">
                        <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: var(--spacing-xs); color: var(--color-text);">Precision-Recall Curve</h3>
                        <p style="color: var(--color-text-light); font-size: 0.85rem; margin-bottom: var(--spacing-sm);">Shows the trade-off between precision and recall across different classes. mAP@0.5: 0.596</p>
                        <div class="chart-image-wrapper">
                            <img src="{{ url_for('static', filename='images/precision recall curve.png') }}" alt="Precision-Recall Curve" style="width: 100%; border-radius: var(--radius-md); box-shadow: var(--shadow-md);">
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: var(--spacing-xs); color: var(--color-text);">F1-Confidence Curve</h3>
                        <p style="color: var(--color-text-light); font-size: 0.85rem; margin-bottom: var(--spacing-sm);">F1 score vs confidence threshold. Optimal threshold: 0.324 with F1: 0.58</p>
                        <div class="chart-image-wrapper">
                            <img src="{{ url_for('static', filename='images/Confidence curve.png') }}" alt="F1-Confidence Curve" style="width: 100%; border-radius: var(--radius-md); box-shadow: var(--shadow-md);">
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: var(--spacing-xs); color: var(--color-text);">Precision-Confidence Curve</h3>
                        <p style="color: var(--color-text-light); font-size: 0.85rem; margin-bottom: var(--spacing-sm);">Precision vs confidence threshold. Achieves 91% precision at 0.993 confidence</p>
                        <div class="chart-image-wrapper">
                            <img src="{{ url_for('static', filename='images/presision confidence matrix.png') }}" alt="Precision-Confidence Curve" style="width: 100%; border-radius: var(--radius-md); box-shadow: var(--shadow-md);">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Training Metrics -->
        <section class="dataset" id="training">
            <div class="container">
                <h2>Training Metrics</h2>
                <p>
                    The model was trained with careful monitoring of loss functions across 100 epochs. Early stopping
                    with a patience of 50 epochs was implemented to prevent overfitting and ensure optimal generalization.
                </p>
                <div class="table-wrapper">
                    <table class="data-table">
                        <caption>Training Configuration & Loss Metrics</caption>
                        <thead>
                            <tr>
                                <th scope="col">Metric Type</th>
                                <th scope="col">Description</th>
                                <th scope="col">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Box Loss</strong></td>
                                <td>Bounding box regression loss (train/validation)</td>
                                <td>Monitored and optimized</td>
                            </tr>
                            <tr>
                                <td><strong>Classification Loss</strong></td>
                                <td>Object classification loss (train/validation)</td>
                                <td>Monitored and optimized</td>
                            </tr>
                            <tr>
                                <td><strong>DFL Loss</strong></td>
                                <td>Distribution Focal Loss for bounding box refinement</td>
                                <td>Monitored and optimized</td>
                            </tr>
                            <tr>
                                <td><strong>Learning Curves</strong></td>
                                <td>Training and validation loss convergence</td>
                                <td>Analyzed for optimal stopping</td>
                            </tr>
                            <tr>
                                <td><strong>Confusion Matrix</strong></td>
                                <td>Normalized confusion matrix for class predictions</td>
                                <td>Generated for validation set</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Model Capabilities -->
        <section class="model-architecture" id="capabilities">
            <div class="container">
                <h2>Model Capabilities</h2>
                <p>
                    The fine-tuned YOLOv8n model demonstrates strong performance in detecting camouflaged military
                    soldiers with the following capabilities:
                </p>
                <div class="table-wrapper">
                    <table class="data-table">
                        <caption>Detection Capabilities</caption>
                        <thead>
                            <tr>
                                <th scope="col">Feature</th>
                                <th scope="col">Capability</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Real-time Detection</strong></td>
                                <td>Fast inference suitable for real-time applications</td>
                            </tr>
                            <tr>
                                <td><strong>Camouflage Handling</strong></td>
                                <td>Specialized for detecting soldiers in camouflage patterns</td>
                            </tr>
                            <tr>
                                <td><strong>Density Estimation</strong></td>
                                <td>Counts and estimates soldier density in images</td>
                            </tr>
                            <tr>
                                <td><strong>Confidence Thresholding</strong></td>
                                <td>Configurable confidence threshold (default: 0.5)</td>
                            </tr>
                            <tr>
                                <td><strong>Bounding Box Localization</strong></td>
                                <td>Precise bounding box coordinates for each detection</td>
                            </tr>
                            <tr>
                                <td><strong>Image Resolution</strong></td>
                                <td>Optimized for 640x640 pixel input images</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Evaluation Notes -->
        <section class="dataset" id="evaluation">
            <div class="container">
                <h2>Evaluation Methodology</h2>
                <p>
                    The model performance was evaluated using standard object detection metrics on a held-out validation set.
                    The evaluation process includes:
                </p>
                <ul class="evaluation-list">
                    <li><strong>Validation Set Testing:</strong> Model evaluated on separate validation images not seen during training</li>
                    <li><strong>Confusion Matrix Analysis:</strong> Normalized confusion matrix generated to understand classification performance</li>
                    <li><strong>Learning Curve Analysis:</strong> Training and validation losses monitored to ensure proper convergence</li>
                    <li><strong>Best Model Selection:</strong> Model checkpoint with best validation performance selected for deployment</li>
                    <li><strong>Visual Validation:</strong> Sample validation images with predictions visualized for qualitative assessment</li>
                </ul>
                
                <!-- Confusion Matrix Visualization -->
                <div style="margin-top: var(--spacing-md);">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--spacing-xs); color: var(--color-text);">Confusion Matrix</h3>
                    <p style="color: var(--color-text-light); font-size: 0.9rem; margin-bottom: var(--spacing-md); max-width: 75ch;">
                        The confusion matrix shows the classification performance across all 13 classes. Diagonal values represent correct predictions, 
                        while off-diagonal values indicate misclassifications. High diagonal values for classes like military_tank (1592), 
                        camouflage_soldier (427), and soldier (533) demonstrate strong detection capabilities.
                    </p>
                    <div class="model-image-container" style="max-width: 1000px;">
                        <img src="{{ url_for('static', filename='images/Comfusion matrix.png') }}" alt="Confusion Matrix" style="width: 100%; border-radius: var(--radius-md); box-shadow: var(--shadow-lg);">
            </div>
            </div>
        </div>
    </section>

        <!-- Call to Action -->
        <section class="container" style="margin: var(--spacing-md) 0; text-align: center;">
            <div class="hero-actions">
                <a class="cta-button primary" href="{{ url_for('predict') }}">Test Model Now</a>
                <a class="cta-button secondary" href="{{ url_for('model_info') }}">View Model Details</a>
        </div>
    </section>
    </main>
{% endblock %}

